<root BTCPP_format="4" main_tree_to_execute="MainTree">
  <BehaviorTree ID="MainTree">
    <ReactiveFallback name="main_selector">
      <ReactiveSequence name="detect_check">
        <IsInState state="1" entity="{entity}" />
        <SubTree ID="DetectTree" entity="{entity}" deltaTime="{deltaTime}" />
      </ReactiveSequence>
      
      <ReactiveSequence name="idle_check">
        <IsInState state="0" entity="{entity}" />
        <SubTree ID="IdleTree" entity="{entity}" deltaTime="{deltaTime}" />
      </ReactiveSequence>

    </ReactiveFallback>
  </BehaviorTree>

  <BehaviorTree ID="IdleTree">
    <Sequence name="patrol_sequence">
      <PatrolTo entity="{entity}" targetPosition="{pos}" direction="{dir}" duration="{dur}" />
      <MoveTo entity="{entity}" position="{pos}" />
      <TurnTo entity="{entity}" direction="{dir}" />
      <WaitFor entity="{entity}" deltaTime="{deltaTime}" duration="{dur}" />
    </Sequence>
  </BehaviorTree>

  <BehaviorTree ID="DetectTree">
    <ReactiveSequence name="detect_sequence">
      <IsEnemyVisible entity="{entity}" otherEntity="{otherEntity}" otherPosition="{otherPosition}" direction="{direction}" />
      <WaitFor entity="{entity}" deltaTime="{deltaTime}" duration="1" />
      <TurnTo entity="{entity}" direction="{direction}" />
    </ReactiveSequence>
  </BehaviorTree>
</root>